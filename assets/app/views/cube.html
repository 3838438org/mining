<div class="row">
    <div class="col-lg-12">
        <h1><i class="fa fa-globe"></i> Cube</h1>
        <ol class="breadcrumb">
            <li><a href="#/"><i class="icon-dashboard"></i> Admin</a></li>
            <li class="active">Cube</li>
        </ol>
    </div>
</div>
<div class="row">
    <div class="col-lg-6">
        <form name="form_cube" accept-charset="utf-8" role="form" ng-submit="save(cube)">
            <pre>
            [[ cube | json ]]
            </pre>
            <div class="form-group">
                <label for="cube_name">Name *</label>
                <input type="text" id="cube_name" ng-model="cube.name" class="form-control" required>
            </div>
            <div class="form-group">
                <label for="cube_connection">Connection *</label>
                <select id="cube_connection" ui-select2 ng-model="cube.connection" class="form-control" required>
                    <option ng-repeat="c in connections" value="[[ c.slug ]]">[[ c.name ]]</option>
                </select>
            </div>
            <div class="form-group">
                <label for="cube_schedule_type">Scheduler</label>
                <select class="form-control" ui-select2 id="cube_schedule_type" ng-change="changeSchedulerType()"
                        ng-model="cube.scheduler_type">
                    <option value="" selected="selected">No</option>
                    <option ng-repeat="t in scheduler_types" value="[[ t.key ]]">[[ t.val ]]</option>
                </select>

                <div ng-show="show_h">
                    <label>Hour</label><input class="form-control" id="hour" ng-model="hour" type="number" min="0"
                                              max="23"/>
                </div>
                <div ng-show="show_m">
                    <label>Min</label><input class="form-control" id="min" ng-model="min" type="number" min="0"
                                             max="59"/>
                </div>
            </div>
            <div class="form-group">
                <label for="cube_sql">Query *</label>
                <textarea ui-codemirror="editorOptions" id="cube_sql" ng-model="cube.sql"></textarea>
            </div>
            <label><input type="checkbox" ng-model="force_save" checked/> Force save</label>
            <button type="submit" class="btn btn-primary"
                    ng-disabled="(form_cube.$invalid && !cube.sql) || (!force_save && !cube_valid)">Save
            </button>
            <input class="btn btn-info" type="button" value="Query test" ng-disabled="ajaxload" ng-click="testquery()"/>
            <button type="button" class="btn btn-success" ng-click="newForm()">New</button>
        </form>
    </div>
    <div class="col-lg-6">
        <table class="table table-bordered table-responsive table-hover">
            <thead>
            <th>
            </th>
            <th>
                Name
            </th>
            <th>
                Connection
            </th>
            <th>
                Status
            </th>
            </thead>
            <tbody ng-repeat="c in cubes">
            <tr>
                <td>
                    <a ng-click="selectCube(c)"><i class="fa fa-pencil"></i></a>
                    <a ng-click="deleteCube(c)"><i class="fa fa-trash-o"></i></a>
                </td>
                <td>
                    [[c.name]]
                </td>
                <td>
                    [[c.connection]]
                </td>
                <td>
                    <i class="fa" ng-class="{'fa-thumbs-up':c.status, 'fa-thumbs-down': !c.status}"></i>
                </td>
            </tr>
            <tr ng-show="c.scheduler_status">
                <td colspan="2">
                    Scheduler
                </td>
                <td>
                    [[ c.scheduler_type ]]
                </td>
                <td>
                    [[ c.scheduler_interval ]]
                </td>
            </tr>
            <tr>
                <td colspan="4">
                    [[ c.sql ]]
                </td>
            </tr>
            </tbody>
        </table>
    </div>
</div><!-- /.row -->